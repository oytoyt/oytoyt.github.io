function getQueryString(o){let e=new RegExp("(^|&)"+o+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null}window.onload=function(){function o(){console.log("摇一摇"),n&&n.emit("console_message",e),!1===i.audioLoaded&&(i.audioLoaded=!0,i.shakeAudio.play(),$("#id-shake-image").addClass("animated shake")),clearTimeout(),setTimeout(function(){i.audioLoaded=!1,$("#id-shake-image").removeClass("animated shake")},1e3)}const e=getQueryString("openid");let n;this.audioLoaded=!1,this.shakeAudio=new Audio,this.shakeAudio.src="source/shake_sound.mp3",setTimeout(()=>{console.log("跳转到开奖页面"),window.location.href=`${location.origin}/reward.html?openid=${e}`},25e3);const i=this;new Shake({threshold:15}).start(),window.addEventListener("shake",o,!1),window.addEventListener("touchstart",o,!1),(n=io("http://119.23.136.26:7009/reward")).on("connect",function(){console.log("建立socket连接"),console.log(n.id),n.on("server_message",function(o){console.log("服务端消息"),console.log(o),o&&o.length>0&&o.forEach((o,n)=>{const{openid:i}=o;if(i===e){let o=1;0===n?o=2:1===n?o=1:2===n&&(o=2),window.location.href=`${location.origin}/reward.html?ranking=${o}`}})})})};